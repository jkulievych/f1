{% extends "base.html" %}

{# Встановлюємо заголовок вкладки браузера #}
{% block title %}Standings - F1 Dashboard{% endblock %}

{# Додаємо CSS, специфічний для цієї сторінки (вкладки) #}
{% block head %}
    <style>
        .tab-container {
            width: 100%;
            margin: 20px auto;
        }
        .tab {
            overflow: hidden;
            border-bottom: 2px solid var(--f1-border);
            margin-bottom: 20px;
        }
        .tab button {
            background-color: transparent;
            float: left;
            border: none;
            outline: none;
            cursor: pointer;
            padding: 14px 20px;
            font-family: 'Formula1', sans-serif;
            font-size: 1.1rem;
            font-weight: bold;
            color: var(--f1-text-secondary);
            transition: 0.3s;
            border-bottom: 4px solid transparent;
        }
        .tab button:hover {
            color: var(--f1-text);
        }
        .tab button.active {
            color: var(--f1-text);
            border-bottom: 4px solid var(--f1-red);
        }
        .tabcontent {
            display: none;
            animation: fadeEffect 0.5s;
        }
        @keyframes fadeEffect {
            from {opacity: 0;}
            to {opacity: 1;}
        }

        .nav-links {
            margin-top: 30px;
            text-align: center;
        }
    </style>
{% endblock %}

{# Основний контент сторінки #}
{% block content %}
    <h2>F1 Championship Standings ({{ year }} Season)</h2>

    <div class="tab-container">
        <div class="tab">
            <button class="tablinks" onclick="openTab(event, 'DriverStandings')" id="defaultOpen">Drivers</button>
            <button class="tablinks" onclick="openTab(event, 'ConstructorStandings')">Constructors</button>
        </div>

        <div id="DriverStandings" class="tabcontent">
            <table>
                <thead>
                    <tr>
                        <th>Pos</th>
                        <th>Name</th>
                        <th>Team</th>
                        <th>Pts</th>
                        <th>Wins</th>
                    </tr>
                </thead>
                <tbody>
                    {% for driver in driver_list %}
                    <tr>
                        <td>{{ driver.position }}</td>
                        <td>
                            <span>{{ driver.givenName }} {{ driver.familyName }}</span>
                        </td>
                        <td>
                            <span>{{ driver.constructorNames[0] }}</span>
                        </td>
                        <td>{{ driver.points }}</td>
                        <td>{{ driver.wins }}</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>

        <div id="ConstructorStandings" class="tabcontent">
            <table>
                <thead>
                    <tr>
                        <th>Pos</th>
                        <th>Name</th>
                        <th>Pts</th>
                        <th>Wins</th>
                    </tr>
                </thead>
                <tbody>
                    {% for team in team_list %}
                    <tr>
                        <td>{{ team.position }}</td>
                        <td>
                            <span>{{ team.constructorName }}</span>
                        </td>
                        <td>{{ team.points }}</td>
                        <td>{{ team.wins }}</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>

    <div class="nav-links">
        <a href="{{ url_for('show_season_schedule', year=year) }}">View {{ year }} Schedule &rarr;</a>
    </div>
{% endblock %}


{#
  =====================================================
   ОНОВЛЕНИЙ JAVASCRIPT: (Об'єднано 2 скрипти)
  =====================================================
#}
{% block scripts %}
    <script>
        // --- 1. ЛОГІКА ДЛЯ ВКЛАДОК ---
        function openTab(evt, tabName) {
            var i, tabcontent, tablinks;
            tabcontent = document.getElementsByClassName("tabcontent");
            for (i = 0; i < tabcontent.length; i++) {
                tabcontent[i].style.display = "none";
            }
            tablinks = document.getElementsByClassName("tablinks");
            for (i = 0; i < tablinks.length; i++) {
                tablinks[i].className = tablinks[i].className.replace(" active", "");
            }
            document.getElementById(tabName).style.display = "block";
            evt.currentTarget.className += " active";
        }


        // --- 2. ЛОГІКА PRELOADER + АКТИВАЦІЯ (ОБ'ЄДНАНО) ---
        document.addEventListener("DOMContentLoaded", function() {
            // 2a. АКТИВАЦІЯ ТАБУ: Викликається, коли DOM готовий
            document.getElementById("defaultOpen").click();

            // 2b. ЛОГІКА PRELOADER (з base.html)
            const preloader = document.getElementById('preloader-overlay');
            const mainContent = document.getElementById('main-content');

            if (preloader) {
                preloader.style.display = 'none'; // Негайно ховаємо вогні
            }
            if (mainContent) {
                mainContent.classList.add('loaded'); // Негайно показуємо контент
            }
        });
    </script>
{% endblock %}